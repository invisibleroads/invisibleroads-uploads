$.fn.extend({
  'enable': function() {
    var $o = $(this);
    $o.add($o.find('input')).removeAttr('disabled');
  }
});

(function() {

  var $btn_file = $('.btn-file');
  var $btn_file_input = $btn_file.find('input');

  // Show upload feedback and trigger event
  $btn_file_input.fileupload({
    dataType: 'json',
    fail: function(e, d) {
      console.log(d);
    },
    progressall: function(e, d) {
      var $o = $(this).parent('span');
      $o.next('.feedback').text(parseInt(d.loaded / d.total * 100) + '%');
    },
    done: function(e, d) {
      var $o = $(this).parent('span'), x = d.result;
      $o.next('.feedback').text('');
      $o.data('upload_id', x.upload_id).trigger('uploaded.ir', x);
    }
  });

}());
